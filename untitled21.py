# -*- coding: utf-8 -*-
"""Untitled21.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1TafCF5e3Jzcxi4-WYSNMJpyOjiG0PifD
"""

import streamlit as st

# ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ã‚’è¡Œã†é–¢æ•°
def run_length_encoding(input_str):
    encoded_str = ''
    count = 1
    encoded_data = []

    if len(input_str) == 0:
        return encoded_str, encoded_data

    for i in range(1, len(input_str)):
        if input_str[i] == input_str[i - 1]:
            count += 1
        else:
            encoded_str += input_str[i - 1] + str(count)
            encoded_data.append((input_str[i - 1], count))
            count = 1

    encoded_str += input_str[-1] + str(count)
    encoded_data.append((input_str[-1], count))

    return encoded_str, encoded_data

# åœ§ç¸®ç‡ã‚’æ±‚ã‚ã‚‹é–¢æ•°
def calculate_compression_rate(input_str, encoded_str):
    original_size = len(input_str)
    compressed_size = len(encoded_str)
    compression_rate = (1 - compressed_size / original_size) * 100
    return original_size, compressed_size, compression_rate

# Streamlit ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã® UI
st.title('ğŸ“¦ ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®ãƒ„ãƒ¼ãƒ«')

# å…¥åŠ›
input_str = st.text_input('âœï¸ åŠè§’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:')

if input_str:
    # åœ§ç¸®å‡¦ç†
    encoded_str, encoded_data = run_length_encoding(input_str)
    original_size, compressed_size, compression_rate = calculate_compression_rate(input_str, encoded_str)

    # å…ƒã®ãƒ‡ãƒ¼ã‚¿
    st.header('ğŸ—ƒï¸ å…ƒã®ãƒ‡ãƒ¼ã‚¿')
    st.info(f'å…¥åŠ›ãƒ‡ãƒ¼ã‚¿: **{input_str}**')
    st.write(f'å…ƒã®ãƒ‡ãƒ¼ã‚¿ã®ã‚µã‚¤ã‚º: **{original_size} ãƒã‚¤ãƒˆ**')

    # åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿
    st.header('ğŸ”§ åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿')
    st.success(f'ãƒ©ãƒ³ãƒ¬ãƒ³ã‚°ã‚¹åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿: **{encoded_str}**')
    st.write(f'åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿ã®ã‚µã‚¤ã‚º: **{compressed_size} ãƒã‚¤ãƒˆ**')

    # åœ§ç¸®ç‡
    st.header('ğŸ“‰ åœ§ç¸®ç‡ã®çµæœ')
    st.latex(r'''
    åœ§ç¸®ç‡ = \frac{{\text{{å…ƒã®ã‚µã‚¤ã‚º}} - \text{{åœ§ç¸®å¾Œã®ã‚µã‚¤ã‚º}}}}{{\text{{å…ƒã®ã‚µã‚¤ã‚º}}}} \times 100
    ''')
    st.latex(rf'''
    åœ§ç¸®ç‡ = \frac{{{original_size} - {compressed_size}}}{{{original_size}}} \times 100 = {compression_rate:.2f}\%
    ''')
    st.warning(f'åœ§ç¸®ç‡: **{compression_rate:.2f}%**')

    # åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿è©³ç´°
    st.header('ğŸ” åœ§ç¸®å¾Œã®ãƒ‡ãƒ¼ã‚¿è©³ç´°')
    st.table([{'æ–‡å­—': char, 'å‡ºç¾å›æ•°': count} for char, count in encoded_data])

    # æ³¨æ„äº‹é …
    st.caption('â€» åŠè§’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆä»¥å¤–ã®å…¥åŠ›ã¯ç„¡è¦–ã•ã‚Œã¾ã™ã€‚')